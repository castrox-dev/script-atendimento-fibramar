<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Script de Atendimento - Fibramar Internet</title>
    
    <!-- Preload critical resources -->
    <link rel="preload" href="styles.css" as="style">
    <link rel="preload" href="script.js" as="script">
    <link rel="preload" href="script-data.json" as="fetch" crossorigin>
    <link rel="preload" href="manifest.json" as="fetch" crossorigin>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- DNS prefetch and preconnect for external resources -->
    <link rel="preconnect" href="https://api.open-meteo.com">
    <link rel="preconnect" href="https://castrox-dev.github.io">
    <link rel="preconnect" href="https://raw.githubusercontent.com">
    <link rel="dns-prefetch" href="https://api.open-meteo.com">
    <link rel="dns-prefetch" href="https://castrox-dev.github.io">
    <link rel="dns-prefetch" href="https://raw.githubusercontent.com">
    
    <!-- Meta tags -->
    <meta name="description" content="Script de atendimento otimizado para Fibramar Internet - PWA para GitHub Pages">
    <meta name="keywords" content="atendimento, suporte, fibramar, internet, pwa, github pages">
    <meta name="author" content="Fibramar Internet">
    <meta name="theme-color" content="#667eea">
    
    <!-- PWA Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Fibramar Script">
    <meta name="msapplication-TileColor" content="#667eea">
    <meta name="msapplication-config" content="browserconfig.xml">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://castrox-dev.github.io/script-atendimento-fibramar/">
    <meta property="og:title" content="Script de Atendimento - Fibramar Internet">
    <meta property="og:description" content="Script de atendimento otimizado para Fibramar Internet">
    <meta property="og:image" content="https://castrox-dev.github.io/script-atendimento-fibramar/manifest.json">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://castrox-dev.github.io/script-atendimento-fibramar/">
    <meta property="twitter:title" content="Script de Atendimento - Fibramar Internet">
    <meta property="twitter:description" content="Script de atendimento otimizado para Fibramar Internet">
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="datetime-weather">
                <div class="datetime" id="datetime"></div>
                <div class="weather" id="weather">
                    <span>üå§Ô∏è</span>
                    <span id="temperature">Carregando...</span>
                </div>
                <div class="connectivity-indicator" id="connectivityIndicator">
                    <span id="connectivityIcon">üü¢</span>
                    <span id="connectivityText">Online</span>
                </div>
            </div>
            <div class="attendant-section">
                <label for="attendantName">Nome do Atendente:</label>
                <input type="text" id="attendantName" class="attendant-input" placeholder="Digite seu nome">
            </div>
            <button class="theme-toggle" id="themeToggle">
                <span id="themeIcon">üåô</span>
                <span id="themeText">Modo Escuro</span>
            </button>
        </div>

        <div class="content">
            <div class="search-container">
                <input type="text" id="searchBox" class="search-box" placeholder="Pesquisar mensagens...">
                <span class="search-icon">üîç</span>
            </div>
            <div class="topics" id="topics"></div>
        </div>
    </div>

    <!-- Notepad -->
    <div class="notepad" id="notepad">
        <div class="notepad-header" id="notepadHeader">
            <div class="notepad-title">üìù Bloco de Notas</div>
            <div class="notepad-controls">
                <button class="notepad-btn" id="minimizeNotepad" title="Minimizar">‚àí</button>
                <button class="notepad-btn" id="closeNotepad" title="Fechar">√ó</button>
            </div>
        </div>
        <div class="notepad-content">
            <textarea id="notepadContent" class="notepad-textarea" placeholder="Digite suas anota√ß√µes aqui..."></textarea>
        </div>
        <div class="notepad-footer">
            <div class="notepad-actions">
                <button class="notepad-action-btn export" id="exportNotepad">
                    <span>üì§</span> Exportar
                </button>
                <button class="notepad-action-btn import" id="importNotepad">
                    <span>üì•</span> Importar
                </button>
                <button class="notepad-action-btn clear" id="clearNotepad">
                    <span>üóëÔ∏è</span> Limpar
                </button>
            </div>
            <div class="char-count" id="charCount">0 caracteres</div>
        </div>
        <input type="file" id="importFile" accept=".txt" style="display: none;">
    </div>

    <!-- Floating Buttons -->
    <div class="floating-buttons">
        <button class="floating-btn" id="openNotepad" title="Abrir Bloco de Notas">üìù</button>
        <button class="floating-btn" id="openCalculator" title="Abrir Calculadora">üßÆ</button>
    </div>

    <!-- Calculator Modal -->
    <div class="calculator-modal" id="calculatorModal">
        <div class="calculator">
            <h2>üßÆ Calculadora Financeira</h2>
            
            <div class="calc-section">
                <h3>üìä C√°lculo Proporcional</h3>
                <div class="calc-input-group">
                    <label for="propValue">Valor da Mensalidade (R$):</label>
                    <input type="number" id="propValue" class="calc-input" step="0.01">
                </div>
                <div class="calc-input-group">
                    <label for="propDays">Dias Utilizados:</label>
                    <input type="number" id="propDays" class="calc-input">
                </div>
                <button class="calc-btn" onclick="calculateProportional()">Calcular Proporcional</button>
                <div id="propResult" class="calc-result" style="display: none;"></div>
            </div>

            <div class="calc-section">
                <h3>üìã C√°lculo de Acordo</h3>
                <div class="calc-input-group">
                    <label for="agreementValue">Valor Total (R$):</label>
                    <input type="number" id="agreementValue" class="calc-input" step="0.01">
                </div>
                <div class="calc-input-group">
                    <label for="agreementDiscount">Desconto (%):</label>
                    <input type="number" id="agreementDiscount" class="calc-input" step="0.01">
                </div>
                <button class="calc-btn" onclick="calculateAgreement()">Calcular Acordo</button>
                <div id="agreementResult" class="calc-result" style="display: none;"></div>
            </div>

            <div class="calc-section">
                <h3>üí∞ C√°lculo de Comiss√£o</h3>
                <div class="calc-input-group">
                    <label for="commissionValue">Valor da Venda (R$):</label>
                    <input type="number" id="commissionValue" class="calc-input" step="0.01">
                </div>
                <div class="calc-input-group">
                    <label for="commissionRate">Taxa de Comiss√£o (%):</label>
                    <input type="number" id="commissionRate" class="calc-input" step="0.01">
                </div>
                <button class="calc-btn" onclick="calculateCommission()">Calcular Comiss√£o</button>
                <div id="commissionResult" class="calc-result" style="display: none;"></div>
            </div>

            <button class="calc-btn" onclick="closeCalculator()" style="background: #e74c3c;">Fechar</button>
        </div>
    </div>

    <!-- Analytics Panel -->
    <div id="analyticsPanel" class="analytics-panel" style="display: none;">
        <div class="analytics-content">
            <div class="analytics-header">
                <h3>üìä Analytics do Sistema</h3>
                <button class="close-btn" onclick="closeAnalytics()">√ó</button>
            </div>
            <div class="analytics-body">
                <div class="analytics-stats">
                    <div class="stat-card">
                        <h4>Sess√£o Atual</h4>
                        <p id="sessionDuration">--</p>
                        <small>Dura√ß√£o da sess√£o</small>
                    </div>
                    <div class="stat-card">
                        <h4>Mensagens Copiadas</h4>
                        <p id="messagesCopied">--</p>
                        <small>Nesta sess√£o</small>
                    </div>
                    <div class="stat-card">
                        <h4>Calculadora</h4>
                        <p id="calculatorUsage">--</p>
                        <small>Usos da calculadora</small>
                    </div>
                    <div class="stat-card">
                        <h4>Bloco de Notas</h4>
                        <p id="notepadUsage">--</p>
                        <small>Vezes aberto</small>
                    </div>
                </div>
                <div class="analytics-actions">
                    <button class="analytics-btn" onclick="exportAnalytics()">üì• Exportar Dados</button>
                    <button class="analytics-btn" onclick="clearAnalytics()">üóëÔ∏è Limpar Dados</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Backup Panel -->
    <div id="backupPanel" class="backup-panel" style="display: none;">
        <div class="backup-content">
            <div class="backup-header">
                <h3>üîÑ Sistema de Backup</h3>
                <button class="close-btn" onclick="closeBackup()">‚úï</button>
            </div>
            
            <div class="backup-stats">
                <div class="stat-card">
                    <div class="stat-label">Total de Backups</div>
                    <div class="stat-value" id="totalBackups">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">√öltimo Backup</div>
                    <div class="stat-value" id="lastBackup">Nunca</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Tamanho Total</div>
                    <div class="stat-value" id="backupSize">0 KB</div>
                </div>
            </div>

            <div class="backup-actions">
                <div class="backup-section">
                    <h4>Criar Backup</h4>
                    <button class="backup-btn" onclick="createManualBackup()">üíæ Backup Manual</button>
                    <button class="backup-btn" onclick="exportBackup()">üì§ Exportar Backup</button>
                </div>

                <div class="backup-section">
                    <h4>Restaurar Backup</h4>
                    <div class="backup-list" id="backupList">
                        <!-- Lista de backups ser√° preenchida dinamicamente -->
                    </div>
                    <input type="file" id="backupFileInput" accept=".json" style="display: none;" onchange="importBackup(event)">
                    <button class="backup-btn" onclick="document.getElementById('backupFileInput').click()">üì• Importar Backup</button>
                </div>

                <div class="backup-section">
                    <h4>Manuten√ß√£o</h4>
                    <button class="backup-btn danger" onclick="clearOldBackups()">üóëÔ∏è Limpar Backups Antigos</button>
                    <button class="backup-btn danger" onclick="clearAllBackups()">‚ö†Ô∏è Limpar Todos os Backups</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Painel de Atalhos de Teclado -->
    <div id="shortcutsPanel" class="shortcuts-panel" style="display: none;">
        <div class="shortcuts-content">
            <div class="shortcuts-header">
                <h3>‚å®Ô∏è Atalhos de Teclado</h3>
                <button class="close-btn" onclick="closeShortcutsPanel()">‚úï</button>
            </div>

            <div class="shortcuts-stats">
                <div class="shortcuts-info">
                    <p>Personalize os atalhos de teclado para agilizar seu trabalho</p>
                </div>
            </div>

            <div class="shortcuts-actions">
                <div class="shortcuts-section">
                    <h4>Atalhos Dispon√≠veis</h4>
                    <div class="shortcuts-list" id="shortcutsList">
                        <!-- Lista de atalhos ser√° preenchida dinamicamente -->
                    </div>
                </div>

                <div class="shortcuts-section">
                    <h4>Gerenciar Atalhos</h4>
                    <button class="shortcuts-btn" onclick="exportShortcuts()">üì§ Exportar Atalhos</button>
                    <input type="file" id="shortcutsFileInput" accept=".json" style="display: none;" onchange="importShortcuts(event)">
                    <button class="shortcuts-btn" onclick="document.getElementById('shortcutsFileInput').click()">üì• Importar Atalhos</button>
                    <button class="shortcuts-btn danger" onclick="resetAllShortcuts()">üîÑ Resetar Todos</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Buttons -->
    <button class="floating-btn analytics-btn-float" id="openAnalytics" title="Ver Analytics" style="bottom: 20px; right: 140px;">üìä</button>
    <button class="floating-btn backup-btn-float" id="openBackup" title="Sistema de Backup" style="bottom: 20px; right: 80px;">üîÑ</button>



    <script src="script.js" defer></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('Service Worker registrado:', registration.scope);
                        
                        // Limpeza peri√≥dica de cache
                        setInterval(() => {
                            registration.active?.postMessage({ type: 'CLEAN_CACHE' });
                        }, 60 * 60 * 1000); // 1 hora
                    })
                    .catch(error => {
                        console.warn('Falha no registro do Service Worker:', error);
                    });
            });
        }
    </script>
</body>
</html>
