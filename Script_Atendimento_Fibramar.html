<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Script de Atendimento - Fibramar Internet</title>
    
    <!-- Preload critical resources -->
    <link rel="preload" href="styles.css" as="style">
    <link rel="preload" href="script.js" as="script">
    <link rel="preload" href="script-data.json" as="fetch" crossorigin>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- DNS prefetch for external resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="https://api.openweathermap.org">
    
    <!-- Meta tags -->
    <meta name="description" content="Script de atendimento otimizado para Fibramar Internet">
    <meta name="keywords" content="atendimento, suporte, fibramar, internet">
    <meta name="author" content="Fibramar Internet">
    <meta name="theme-color" content="#667eea">
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="datetime-weather">
                <div class="datetime" id="datetime"></div>
                <div class="weather" id="weather">
                    <span>üå§Ô∏è</span>
                    <span id="temperature">Carregando...</span>
                </div>
            </div>
            <div class="attendant-section">
                <label for="attendantName">Nome do Atendente:</label>
                <input type="text" id="attendantName" class="attendant-input" placeholder="Digite seu nome">
            </div>
            <button class="theme-toggle" id="themeToggle">
                <span id="themeIcon">üåô</span>
                <span id="themeText">Modo Escuro</span>
            </button>
        </div>

        <div class="content">
            <div class="search-container">
                <input type="text" id="searchBox" class="search-box" placeholder="Pesquisar mensagens...">
                <span class="search-icon">üîç</span>
            </div>
            <div class="topics" id="topics"></div>
        </div>
    </div>

    <!-- Notepad -->
    <div class="notepad" id="notepad">
        <div class="notepad-header" id="notepadHeader">
            <div class="notepad-title">üìù Bloco de Notas</div>
            <div class="notepad-controls">
                <button class="notepad-btn" id="minimizeNotepad" title="Minimizar">‚àí</button>
                <button class="notepad-btn" id="closeNotepad" title="Fechar">√ó</button>
            </div>
        </div>
        <div class="notepad-content">
            <textarea id="notepadContent" class="notepad-textarea" placeholder="Digite suas anota√ß√µes aqui..."></textarea>
        </div>
        <div class="notepad-footer">
            <div class="notepad-actions">
                <button class="notepad-action-btn export" id="exportNotepad">
                    <span>üì§</span> Exportar
                </button>
                <button class="notepad-action-btn import" id="importNotepad">
                    <span>üì•</span> Importar
                </button>
                <button class="notepad-action-btn clear" id="clearNotepad">
                    <span>üóëÔ∏è</span> Limpar
                </button>
            </div>
            <div class="char-count" id="charCount">0 caracteres</div>
        </div>
        <input type="file" id="importFile" accept=".txt" style="display: none;">
    </div>

    <!-- Floating Buttons -->
    <div class="floating-buttons">
        <button class="floating-btn" id="openNotepad" title="Abrir Bloco de Notas">üìù</button>
        <button class="floating-btn" id="openCalculator" title="Abrir Calculadora">üßÆ</button>
    </div>

    <!-- Calculator Modal -->
    <div class="calculator-modal" id="calculatorModal">
        <div class="calculator">
            <h2>üßÆ Calculadora Financeira</h2>
            
            <div class="calc-section">
                <h3>üìä C√°lculo Proporcional</h3>
                <div class="calc-input-group">
                    <label for="propValue">Valor da Mensalidade (R$):</label>
                    <input type="number" id="propValue" class="calc-input" step="0.01">
                </div>
                <div class="calc-input-group">
                    <label for="propDays">Dias Utilizados:</label>
                    <input type="number" id="propDays" class="calc-input">
                </div>
                <button class="calc-btn" onclick="calculateProportional()">Calcular Proporcional</button>
                <div id="propResult" class="calc-result" style="display: none;"></div>
            </div>

            <div class="calc-section">
                <h3>üìã C√°lculo de Acordo</h3>
                <div class="calc-input-group">
                    <label for="agreementValue">Valor Total (R$):</label>
                    <input type="number" id="agreementValue" class="calc-input" step="0.01">
                </div>
                <div class="calc-input-group">
                    <label for="agreementDiscount">Desconto (%):</label>
                    <input type="number" id="agreementDiscount" class="calc-input" step="0.01">
                </div>
                <button class="calc-btn" onclick="calculateAgreement()">Calcular Acordo</button>
                <div id="agreementResult" class="calc-result" style="display: none;"></div>
            </div>

            <div class="calc-section">
                <h3>üí∞ C√°lculo de Comiss√£o</h3>
                <div class="calc-input-group">
                    <label for="commissionValue">Valor da Venda (R$):</label>
                    <input type="number" id="commissionValue" class="calc-input" step="0.01">
                </div>
                <div class="calc-input-group">
                    <label for="commissionRate">Taxa de Comiss√£o (%):</label>
                    <input type="number" id="commissionRate" class="calc-input" step="0.01">
                </div>
                <button class="calc-btn" onclick="calculateCommission()">Calcular Comiss√£o</button>
                <div id="commissionResult" class="calc-result" style="display: none;"></div>
            </div>

            <button class="calc-btn" onclick="closeCalculator()" style="background: #e74c3c;">Fechar</button>
        </div>
    </div>

    <script src="script.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('Service Worker registrado:', registration.scope);
                        
                        // Limpeza peri√≥dica de cache
                        setInterval(() => {
                            registration.active?.postMessage({ type: 'CLEAN_CACHE' });
                        }, 60 * 60 * 1000); // 1 hora
                    })
                    .catch(error => {
                        console.warn('Falha no registro do Service Worker:', error);
                    });
            });
        }
    </script>
</body>
</html>
