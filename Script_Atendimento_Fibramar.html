<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Script de Atendimento - Fibramar Internet</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            transition: background 0.3s ease;
        }

        body.dark-mode {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            margin-right: 390px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: visible;
            transition: all 0.3s ease;
            word-wrap: break-word;
        }

        body.notepad-hidden .container {
            margin-right: auto;
        }

        body.dark-mode .container {
            background: #1e1e1e;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            min-height: 200px;
        }

        body.dark-mode .header {
            background: linear-gradient(135deg, #2d2d44 0%, #1a1a2e 100%);
        }

        .header-info {
            position: absolute;
            top: 15px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 5px;
            align-items: flex-start;
        }

        .datetime-widget {
            font-size: 0.9em;
            opacity: 0.95;
            font-weight: 500;
        }

        .weather-widget {
            font-size: 0.85em;
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .name-config {
            position: absolute;
            bottom: 20px;
            left: 20px;
            display: flex;
            align-items: center;
            gap: 6px;
            z-index: 10;
        }

        .name-config label {
            font-size: 0.7em;
            font-weight: 600;
            opacity: 0.95;
            white-space: nowrap;
        }

        .name-config input {
            padding: 3px 6px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 0.75em;
            font-weight: 500;
            outline: none;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            width: 100px;
            max-width: 100px;
        }

        @media (max-width: 768px) {
            .name-config {
                position: absolute;
                bottom: 10px;
                left: 10px;
            }
            
            .theme-toggle {
                top: 20px;
                right: 20px;
                padding: 8px 16px;
                font-size: 1em;
            }
            
            .name-config input {
                width: 80px;
            }
        }

        .name-config input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .name-config input:focus {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .theme-toggle {
            position: absolute;
            top: 30px;
            right: 30px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            border-radius: 50px;
            padding: 10px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            color: white;
            font-size: 1.1em;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .theme-toggle:active {
            transform: scale(0.95);
        }

        .content {
            padding: 30px;
            transition: background 0.3s ease;
        }

        body.dark-mode .content {
            background: #1e1e1e;
        }

        .topic {
            margin-bottom: 15px;
            border-radius: 10px;
            overflow: visible;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        body.dark-mode .topic {
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        .topic:hover {
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }

        body.dark-mode .topic:hover {
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.7);
        }

        .topic-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        body.dark-mode .topic-header {
            background: linear-gradient(135deg, #2d2d44 0%, #1a1a2e 100%);
        }

        .topic-header:hover {
            background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
        }

        body.dark-mode .topic-header:hover {
            background: linear-gradient(135deg, #1a1a2e 0%, #2d2d44 100%);
        }

        .topic-header h2 {
            font-size: 1.3em;
            font-weight: 600;
        }

        .topic-icon {
            font-size: 1.5em;
            transition: transform 0.3s ease;
        }

        .topic.active .topic-icon {
            transform: rotate(180deg);
        }

        .messages {
            display: none;
            background: #f8f9fa;
            padding: 20px;
            max-height: 0;
            overflow: visible;
            transition: max-height 0.3s ease;
        }

        body.dark-mode .messages {
            background: #2a2a2a;
        }

        .topic.active .messages {
            display: block;
            max-height: none;
            overflow: visible;
        }

        .message-item {
            background: white;
            padding: 15px 20px;
            margin-bottom: 10px;
            border-radius: 8px;
            cursor: pointer;
            border-left: 4px solid #667eea;
            transition: all 0.2s ease;
            position: relative;
            word-wrap: break-word;
            overflow-wrap: break-word;
            white-space: pre-wrap;
        }

        body.dark-mode .message-item {
            background: #333;
            border-left-color: #5a67d8;
        }

        .message-item:hover {
            background: #e8eaf6;
            border-left-color: #764ba2;
            transform: translateX(5px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        body.dark-mode .message-item:hover {
            background: #3a3a3a;
            border-left-color: #7c3aed;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.5);
        }

        .message-item:last-child {
            margin-bottom: 0;
        }

        .message-item::after {
            content: 'üìã Clique para copiar';
            position: absolute;
            right: 10px;
            bottom: 8px;
            font-size: 0.75em;
            color: #667eea;
            opacity: 0;
            transition: opacity 0.2s ease;
            background: rgba(255, 255, 255, 0.9);
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
        }

        body.dark-mode .message-item::after {
            color: #a78bfa;
            background: rgba(51, 51, 51, 0.9);
        }

        .message-item:hover::after {
            opacity: 1;
        }

        .password-item::after {
            content: none !important;
        }

        .message-text {
            white-space: pre-wrap;
            line-height: 1.6;
            color: #333;
            word-wrap: break-word;
            overflow-wrap: break-word;
            max-width: 100%;
            display: block;
            overflow: visible;
            text-overflow: unset;
        }

        body.dark-mode .message-text {
            color: #e0e0e0;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4caf50;
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            opacity: 0;
            transform: translateY(-50px);
            transition: all 0.3s ease;
            z-index: 1000;
            font-weight: 600;
        }

        body.dark-mode .notification {
            background: #66bb6a;
        }

        .notification.show {
            opacity: 1;
            transform: translateY(0);
        }

        .search-box {
            margin-bottom: 30px;
            position: relative;
        }

        .search-box input {
            width: 100%;
            padding: 15px 20px;
            font-size: 1.1em;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            outline: none;
            transition: all 0.3s ease;
            background: white;
            color: #333;
        }

        body.dark-mode .search-box input {
            background: #2a2a2a;
            border-color: #444;
            color: #e0e0e0;
        }

        .search-box input:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        body.dark-mode .search-box input:focus {
            border-color: #5a67d8;
            box-shadow: 0 0 0 3px rgba(90, 103, 216, 0.2);
        }

        body.dark-mode .search-box input::placeholder {
            color: #888;
        }

                .notepad {
            position: fixed;
            bottom: 5px;
            right: 5px;
            width: 350px;
            height: 400px;
            min-width: 250px;
            max-width: 800px;
            min-height: 250px;
            max-height: 90vh;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            z-index: 999;
            transition: none;
            display: flex;
            flex-direction: column;
        }

        body.dark-mode .notepad {
            background: #2a2a2a;
        }

        .notepad.minimized {
            height: 60px;
        }

        .notepad-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
            flex-shrink: 0;
        }

        body.dark-mode .notepad-header {
            background: linear-gradient(135deg, #2d2d44 0%, #1a1a2e 100%);
        }

        .notepad-header h3 {
            font-size: 1.1em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .notepad-toggle {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            transition: all 0.2s ease;
        }

        .notepad-toggle:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .notepad-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            transition: all 0.2s ease;
            margin-left: 5px;
        }

        .notepad-close:hover {
            background: rgba(255, 100, 100, 0.5);
            transform: scale(1.1);
        }

        .notepad.hidden {
            display: none;
        }

        .notepad-reopen {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            display: none;
            align-items: center;
            gap: 8px;
        }

        body.dark-mode .notepad-reopen {
            background: linear-gradient(135deg, #2d2d44 0%, #1a1a2e 100%);
        }

        .notepad-reopen.show {
            display: flex;
        }

        .notepad-reopen:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
        }

        .calculator-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .calculator-backdrop.show {
            display: flex;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .calculator {
            width: 1200px;
            max-width: 95%;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            animation: slideUp 0.3s ease;
        }

        body.dark-mode .calculator {
            background: #2a2a2a;
        }

        @media (max-width: 1200px) {
            .calculator {
                width: 90%;
            }

            .calculator-content {
                flex-direction: column;
            }

            .calc-section {
                flex: none;
            }
        }

        .calculator-header {
            background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
            color: white;
            padding: 12px 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            user-select: none;
        }

        body.dark-mode .calculator-header {
            background: linear-gradient(135deg, #2d5a2e 0%, #1e3a1f 100%);
        }

        .calculator-header h3 {
            font-size: 1.05em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .calculator-close {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3em;
            transition: all 0.2s ease;
        }

        .calculator-close:hover {
            background: rgba(255, 100, 100, 0.5);
            transform: scale(1.1);
        }

        .calculator-content {
            padding: 15px;
            display: flex;
            gap: 15px;
        }

        .calc-section {
            flex: 1;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px solid #e0e0e0;
        }

        body.dark-mode .calc-section {
            background: #1e1e1e;
            border-color: #444;
        }

        .calc-section h4 {
            color: #4caf50;
            margin-bottom: 12px;
            font-size: 1em;
            font-weight: 600;
        }

        body.dark-mode .calc-section h4 {
            color: #66bb6a;
        }

        .calc-input-row {
            display: flex;
            gap: 15px;
            margin-bottom: 12px;
        }

        .calc-input-row .calc-input-group {
            flex: 1;
            margin-bottom: 0;
        }

        .calc-input-group {
            margin-bottom: 10px;
        }

        .calc-input-group label {
            display: block;
            margin-bottom: 4px;
            font-size: 0.85em;
            font-weight: 500;
            color: #666;
        }

        body.dark-mode .calc-input-group label {
            color: #b0b0b0;
        }

        .calc-input-group input {
            width: 100%;
            padding: 8px 10px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 0.9em;
            outline: none;
            transition: all 0.3s ease;
            background: white;
            color: #333;
        }

        @media (max-width: 768px) {
            .calc-input-row {
                flex-direction: column;
                gap: 12px;
            }

            .calc-input-row .calc-input-group {
                margin-bottom: 12px;
            }
        }

        body.dark-mode .calc-input-group input {
            background: #1e1e1e;
            border-color: #444;
            color: #e0e0e0;
        }

        .calc-input-group input:focus {
            border-color: #4caf50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        body.dark-mode .calc-input-group input:focus {
            border-color: #66bb6a;
            box-shadow: 0 0 0 3px rgba(102, 187, 106, 0.2);
        }

        .calc-button {
            width: 100%;
            padding: 10px;
            background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 0.95em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 8px;
        }

        .calc-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.3);
        }

        .calc-button:active {
            transform: translateY(0);
        }

        .calc-result {
            margin-top: 12px;
            padding: 12px;
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            border-radius: 6px;
            display: none;
        }

        body.dark-mode .calc-result {
            background: #1e3a1f;
            border-left-color: #66bb6a;
        }

        .calc-result.show {
            display: block;
        }

        .calc-result-label {
            font-size: 0.8em;
            color: #666;
            margin-bottom: 4px;
        }

        body.dark-mode .calc-result-label {
            color: #b0b0b0;
        }

        .calc-result-value {
            font-size: 1.3em;
            font-weight: bold;
            color: #2e7d32;
        }

        body.dark-mode .calc-result-value {
            color: #81c784;
        }

        .floating-buttons {
            position: fixed;
            bottom: 20px;
            left: 20px;
            display: flex;
            gap: 15px;
            z-index: 998;
        }

        .calculator-open-btn {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #4caf50 0%, #45a049 100%);
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.8em;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.3);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        body.dark-mode .calculator-open-btn {
            background: linear-gradient(135deg, #2d5a2e 0%, #1e3a1f 100%);
        }

        .calculator-open-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.5);
        }

        .calculator-open-btn:active {
            transform: scale(0.95);
        }

        @media (max-width: 768px) {
            .floating-buttons {
                flex-direction: column;
                gap: 10px;
            }
        }

        .notepad-content {
            padding: 15px;
            display: block;
            overflow-y: auto;
            flex: 1;
        }

        .notepad.minimized .notepad-content {
            display: none;
        }

        .notepad-textarea {
            width: 100%;
            height: 100%;
            min-height: 100px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 12px;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 0.95em;
            resize: none;
            outline: none;
            transition: all 0.3s ease;
            background: white;
            color: #333;
            position: relative;
        }


        body.dark-mode .notepad-textarea {
            background: #1e1e1e;
            border-color: #444;
            color: #e0e0e0;
        }

        .notepad-textarea:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        body.dark-mode .notepad-textarea:focus {
            border-color: #5a67d8;
            box-shadow: 0 0 0 3px rgba(90, 103, 216, 0.2);
        }

        .notepad-footer {
            padding: 12px 15px;
            background: #f5f5f5;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid #ddd;
            flex-wrap: wrap;
            gap: 8px;
            flex-shrink: 0;
        }

        body.dark-mode .notepad-footer {
            background: #1a1a1a;
            border-top-color: #333;
        }

        .notepad-actions {
            display: flex;
            gap: 8px;
        }

        .notepad-clear, .notepad-export, .notepad-import-btn {
            background: #f44336;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .notepad-export {
            background: #2196F3;
        }

        .notepad-export:hover {
            background: #1976D2;
            transform: scale(1.05);
        }

        .notepad-import-btn {
            background: #FF9800;
        }

        .notepad-import-btn:hover {
            background: #F57C00;
            transform: scale(1.05);
        }

        .notepad-clear:hover {
            background: #d32f2f;
            transform: scale(1.05);
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .topic-header h2 {
                font-size: 1.1em;
            }

            .message-item::after {
                display: none;
            }

            .theme-toggle {
                top: 20px;
                right: 20px;
                padding: 8px 15px;
                font-size: 1em;
            }

            .container {
                margin-right: auto;
                max-width: 100%;
            }

            .notepad {
                width: calc(100% - 40px);
                left: 20px;
                right: 20px;
            }

            .notepad-textarea {
                min-height: 150px;
            }

            .notepad-reopen {
                padding: 12px 18px;
                font-size: 0.9em;
            }
        }

        .notepad-resize-handle {
            position: absolute;
            top: 0;
            left: 0;
            width: 20px;
            height: 100%;
            cursor: ew-resize;
            z-index: 1000;
        }
        
        .notepad-resize-handle::before {
            content: '';
            position: absolute;
            left: 8px;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 40px;
            background: rgba(102, 126, 234, 0.3);
            border-radius: 2px;
            transition: all 0.2s ease;
        }
        
        .notepad-resize-handle:hover::before {
            background: rgba(102, 126, 234, 0.6);
            height: 60px;
        }
        
        body.dark-mode .notepad-resize-handle::before {
            background: rgba(167, 139, 250, 0.3);
        }
        
        body.dark-mode .notepad-resize-handle:hover::before {
            background: rgba(167, 139, 250, 0.6);
        }


        .notepad-resize-handle-vertical {
            position: absolute;
            top: 0;
            left: 0;
            width: 25px;
            height: 25px;
            cursor: nwse-resize;
            z-index: 1001;
        }
        
        .notepad-resize-handle-vertical::before {
            content: '';
            position: absolute;
            left: 5px;
            top: 5px;
            width: 0;
            height: 0;
            border-left: 12px solid rgba(102, 126, 234, 0.4);
            border-bottom: 12px solid transparent;
            transition: all 0.2s ease;
        }
        
        .notepad-resize-handle-vertical:hover::before {
            border-left-color: rgba(102, 126, 234, 0.7);
        }
        
        body.dark-mode .notepad-resize-handle-vertical::before {
            border-left-color: rgba(167, 139, 250, 0.4);
        }
        
        body.dark-mode .notepad-resize-handle-vertical:hover::before {
            border-left-color: rgba(167, 139, 250, 0.7);
        }

    </style>
</head>
<body>
    <div class="notification" id="notification">‚úì Mensagem copiada!</div>

    <!-- Bloco de Notas -->
    <div class="notepad" id="notepad">
        <div class="notepad-header">
            <h3>üìù Bloco de Notas</h3>
            <div style="display: flex; gap: 5px;">
                <button class="notepad-toggle" id="notepadToggle">‚àí</button>
                <button class="notepad-close" id="notepadClose">‚úï</button>
            </div>
        </div>
        <div class="notepad-content">
            <textarea class="notepad-textarea" id="notepadTextarea" placeholder="Digite suas anota√ß√µes aqui..."></textarea>
        </div>
        <div class="notepad-footer">
            <div class="notepad-actions">
                <button class="notepad-export" id="notepadExport" title="Exportar notas">üíæ Exportar</button>
                <button class="notepad-import-btn" id="notepadImportBtn" title="Importar notas">üìÇ Importar</button>
                <input type="file" id="notepadImport" accept=".txt" style="display: none;">
                <button class="notepad-clear" id="notepadClear">üóëÔ∏è Limpar</button>
            </div>
        </div>
    </div>

    <!-- Bot√µes Flutuantes -->
    <div class="floating-buttons">
        <button class="notepad-reopen" id="notepadReopen">
            üìù Abrir Notas
        </button>
        <button class="calculator-open-btn" id="calculatorOpenBtn" title="Calculadora Financeira">
            üí∞
        </button>
    </div>

    <!-- Calculadora Financeira (Modal) -->
    <div class="calculator-backdrop" id="calculatorBackdrop">
        <div class="calculator" id="calculator">
            <div class="calculator-header">
                <h3>üí∞ Calculadora Financeira</h3>
                <button class="calculator-close" id="calculatorClose">‚úï</button>
            </div>
            <div class="calculator-content">
                <!-- C√°lculo Proporcional -->
                <div class="calc-section">
                    <h4>üìä C√°lculo Proporcional de Uso</h4>
                    <div class="calc-input-group">
                        <label>Valor do Plano (R$)</label>
                        <input type="number" id="valorPlano" placeholder="Ex: 99.99" step="0.01" min="0">
                    </div>
                    <div class="calc-input-group">
                        <label>Dias do M√™s</label>
                        <input type="number" id="diasMes" placeholder="Ex: 30" min="1" max="31">
                    </div>
                    <div class="calc-input-group">
                        <label>Dias Utilizados</label>
                        <input type="number" id="diasUtilizados" placeholder="Ex: 15" min="0">
                    </div>
                    <button class="calc-button" id="calcProporcional">Calcular Proporcional</button>
                    <div class="calc-result" id="resultProporcional">
                        <div class="calc-result-label">Valor Proporcional:</div>
                        <div class="calc-result-value" id="valorProporcional">R$ 0,00</div>
                    </div>
                </div>

                <!-- C√°lculo de Acordo -->
                <div class="calc-section">
                    <h4>ü§ù C√°lculo de Acordo (1 Fatura e Meia)</h4>
                    <div class="calc-input-group">
                        <label>Valor da Fatura (R$)</label>
                        <input type="number" id="valorFatura" placeholder="Ex: 99.99" step="0.01" min="0">
                    </div>
                    <button class="calc-button" id="calcAcordo">Calcular Acordo</button>
                    <div class="calc-result" id="resultAcordo">
                        <div class="calc-result-label">Valor do Acordo (1,5x):</div>
                        <div class="calc-result-value" id="valorAcordo">R$ 0,00</div>
                    </div>
                </div>

                <!-- Calculadora de Comiss√£o -->
                <div class="calc-section">
                    <h4>üí∞ Calculadora de Comiss√£o</h4>
                    <div class="calc-input-group">
                        <label>Quantidade de Cadastros</label>
                        <input type="number" id="qtdCadastros" placeholder="Ex: 5" min="0" value="0">
                    </div>
                    <div class="calc-input-group">
                        <label>Valor Total de Acordos (R$)</label>
                        <input type="number" id="valorAcordos" placeholder="Ex: 500.00" step="0.01" min="0" value="0">
                    </div>
                    <button class="calc-button" id="calcComissao">Calcular Comiss√£o</button>
                    <div class="calc-result" id="resultComissao">
                        <div class="calc-result-label">Sua Comiss√£o Total:</div>
                        <div class="calc-result-value" id="valorComissao">R$ 0,00</div>
                        <div style="font-size: 0.75em; margin-top: 8px; opacity: 0.8;">
                            <div id="detalhesComissao"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <div class="header-info">
                <div class="datetime-widget" id="datetimeWidget">üïê Carregando...</div>
                <div class="weather-widget" id="weatherWidget">üå°Ô∏è Carregando clima...</div>
            </div>
            <div class="name-config">
                <label for="attendantName">üë§ Nome do Atendente:</label>
                <input type="text" id="attendantName" placeholder="Digite seu nome aqui" value="">
            </div>
            <button class="theme-toggle" id="themeToggle">
                <span id="themeIcon">üåô</span>
                <span id="themeText">Dark</span>
            </button>
            <h1>üìû Script de Atendimento</h1>
            <p>Fibramar Internet - Guia R√°pido</p>
        </div>

        <div class="content">
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="üîç Buscar t√≥pico ou mensagem...">
            </div>

            <div id="topics"></div>
        </div>
    </div>

    <script>
        // For√ßar atualiza√ß√£o - timestamp: 2024-12-19
        console.log('Script carregado em:', new Date().toLocaleString());
        
        // For√ßar atualiza√ß√£o do cache
        const currentVersion = '2.0.0';
        const storedVersion = localStorage.getItem('scriptVersion');
        
        if (storedVersion !== currentVersion) {
            localStorage.setItem('scriptVersion', currentVersion);
            console.log('Nova vers√£o detectada:', currentVersion);
            // Limpar cache se necess√°rio
            if ('caches' in window) {
                caches.keys().then(names => {
                    names.forEach(name => {
                        caches.delete(name);
                    });
                });
            }
        }
        
        const scriptData = {
            "‚úÖ IN√çCIO DE ATENDIMENTO": [
                "Ol√°! Seja bem-vindo(a) ao atendimento da Fibramar Internet.\n\nNosso atendimento √© 24 horas, todos os dias.\n\nCaso prefira atendimento por liga√ß√£o, utilize um dos nossos n√∫meros:\n\nüìû 0800 100 3850\nüìû (21) 3864-3850\n\nMeu nome √© [NOME_ATENDENTE], e vou lhe atender agora.\n\nEm que posso ajudar?"
            ],
            "üßæ IDENTIFICA√á√ÉO DO CLIENTE": [
                "[PERIODO]! \nPoderia me informar o nome completo ou o cpf do titular, por gentileza?"
            ],
            "üîö ENCERRAMENTOS": [
                "Por falta de comunica√ß√£o, o atendimento est√° sendo encerrado.\nPara atendimento, pe√ßo que retorne o contato com a nossa central nos telefones: FIBRAMAR: 0800 100 3850 \nOu envie uma mensagem por aqui novamente, nosso atendimento √© 24 horas, todos os dias!\nAgradecemos o seu contato, tenha uma √≥tima semana!",
                "Est√°vamos realizando uma manuten√ß√£o na localidade por√©m j√° normalizou, poderia verificar?",
                "Agrade√ßo por escolher nossos servi√ßos. A equipe da *FIBRAMAR* Est√° √† disposi√ß√£o para qualquer necessidade futura!\n\nCANAIS DE ATENDIMENTO üìûüë®üèªüíª 0800 100 3850",
                "Neste momento estou entrando em meu hor√°rio de almo√ßo, ent√£o irei lhe transferir para que outro atendente possa dar continuidade ao seu atendimento. Tenha um √≥timo dia!",
                "Neste momento estou finalizando o meu expediente, ent√£o irei lhe transferir para que outro atendente possa dar continuidade ao seu atendimento. Tenha uma √≥tima semana!",
                "üõ†Ô∏è NOTIFICA√á√ÉO DE MANUTEN√á√ÉO üõ†Ô∏è\n\nPrezado(a) cliente,\n\nInformamos que nossas equipes t√©cnicas est√£o realizando uma manuten√ß√£o programada na sua localidade.\n\n‚è∞ Previs√£o para normaliza√ß√£o: at√© √†s 18:00h de hoje.\n\nO servi√ßo poder√° ser restabelecido a qualquer momento antes desse hor√°rio.\n\nPedimos desculpas pelo transtorno tempor√°rio e agradecemos sua compreens√£o.\n\nEstamos trabalhando para melhorar cada vez mais nossos servi√ßos.\n\nAtenciosamente,\n\nEquipe Fibramar Internet üß°"
            ],
            "üí∞ FATURAS E BOLETOS": [
                "‚úÖ Seu boleto foi enviado com sucesso! Confira seu e-mail.\n\nOriento em algo mais?",
                "Para acessar suas faturas, entre no link:\n\nhttps://crnetfibramar.com.br/\n\nLogin: Seu CPF (sem pontos ou tra√ßos)\nSenha: Seu CPF (sem pontos ou tra√ßos)"
            ],
            "‚ö†Ô∏è PROBLEMA EXTERNO": [
                "Estamos com uma instabilidade em nossa rede.\n\nNossa equipe t√©cnica j√° est√° em campo resolvendo o mais r√°pido poss√≠vel.\n\nPrevis√£o de normaliza√ß√£o: at√© as 22:00h, podendo voltar a qualquer momento.\n\nPedimos desculpas pelo transtorno e agradecemos sua compreens√£o.\n\nOriento em algo mais?",
                "üì¢ Informativo Emergencial\n\nPrezados clientes,\n\nEstamos enfrentando uma indisponibilidade massiva em nossa operadora de link. Nossa equipe, junto √† operadora, j√° est√° atuando com prioridade m√°xima para restabelecer os servi√ßos o mais r√°pido poss√≠vel.\n\nPedimos desculpas pelos transtornos e agradecemos pela compreens√£o.\n\nAssim que tivermos novidades, manteremos todos informados.\n\nA previs√£o de normaliza√ß√£o √© at√© √†s 18h, podendo ocorrer a qualquer momento antes disso."
            ],
            "üì± PLANOS DISPON√çVEIS": [
                "üì± Plano Essencial ‚Äì 240 MEGA\n\nR$ 59,99/m√™s (pagando at√© o vencimento)\nR$ 79,99/m√™s (ap√≥s vencimento)\n\nInstala√ß√£o Gr√°tis\n\nEste plano n√£o inclui roteador Wi-Fi (voc√™ pode usar o seu pr√≥prio ou alugar por R$ 10,00/m√™s)\n\nInstala√ß√£o em at√© 48h\nPerman√™ncia m√≠nima de 12 meses",
                "üöÄ Plano R√°pido - 400 Mega\n\nR$ 79,99/m√™s* (pagando at√© o vencimento)\nR$ 99,99/m√™s* (ap√≥s vencimento)\n\nSuporte Especializado\n100% Fibra √ìptica\nü§© Instala√ß√£o Gr√°tis\nüòç Super Wi-Fi 5Ghz incluso\n\nüí®Velocidade na medida certa para toda a fam√≠lia navegar, assistir e conectar.\n\nPerman√™ncia m√≠nima de 12 meses",
                "‚ö°Ô∏è Plano Turbo - 500 Mega\n\nR$ 99,99/m√™s* (pagando at√© o vencimento)\nR$ 119,99/m√™s* (ap√≥s vencimento)\n\nSuporte Especializado\n100% Fibra √ìptica\nü§© Instala√ß√£o Gr√°tis\nüòç Super Wi-Fi 5Ghz incluso\n\nüöÄ Ideal para gamers, streamers e multitarefas que n√£o podem ficar sem velocidade.\n\nPerman√™ncia m√≠nima de 12 meses",
                "üî• Plano Ultra + Watch TV, Qualifica e Mediquo - 600 Mega\n\nR$ 119,99/m√™s* (pagando at√© o vencimento)\nR$ 139,99/m√™s* (ap√≥s vencimento)\n\nü§© Instala√ß√£o Gr√°tis\nüòç Super Wi-Fi 5Ghz incluso\n\nüéÅ Benef√≠cios Exclusivos:\n\nüì∫ Watch TV: filmes, s√©ries e canais infantis\nüìΩÔ∏è Paramount\nüéì Qualifica: +220 cursos on-line com certificado reconhecido pela ABED e Carteirinha do Estudante para meia-entrada\nü©∫ Mediquo: consultas m√©dicas ilimitadas 24 h\nüî∞ McAfee antiv√≠rus\n\nPerman√™ncia m√≠nima de 12 meses",
                "Plano Novo ‚Äì 1 GIGA Fibramar Internet ‚ú®\n\nüì° Velocidade: 1 GIGA\nüí∞ Valor: R$ 169,99\n‚û°Ô∏è Promo√ß√£o: pagando at√© o vencimento, sai por apenas R$ 149,99\nüì∂ Wi-Fi 6 incluso üöÄ\nüìÑ Contrato de fidelidade: 12 meses\nüîó Opcional: Repetidor Mesh por apenas R$ 29,99 mensais\n",
                "PLANOS MUQUI",
                "üì± *Plano Essencial ‚Äì 100 MEGA*\n*R$ 59,99/m√™s* (pagando at√© o vencimento)\n*R$ 79,99/m√™s* (ap√≥s vencimento)\n- Instala√ß√£o Gr√°tis\n- *Este plano n√£o inclui roteador Wi-Fi* (voc√™ pode usar o seu pr√≥prio ou alugar por R$ 10,00/m√™s)\n- Instala√ß√£o em at√© 48h\n- Possui fidelidade de 12 meses",
                "üöÄ *Plano R√°pido*\n*300 Mega ‚Ä¢ R$ 89,99/m√™s* (pagando at√© o vencimento)\n*R$ 109,99/m√™s* (ap√≥s vencimento)\n- Suporte Especializado\n- 100% Fibra √ìptica\n- ü§© Instala√ß√£o Gr√°tis\n- üòç Super Wi-Fi 5Ghz incluso\nüí® *Velocidade na medida certa para toda a fam√≠lia navegar, assistir e conectar.*\n\n- Possui fidelidade de 12 meses",
                "‚ö°Ô∏è *Plano Turbo*\n*500 Mega ‚Ä¢ R$ 99,99/m√™s* (pagando at√© o vencimento)\n*R$ 119,99/m√™s* (ap√≥s vencimento)\n- Suporte Especializado\n- 100% Fibra √ìptica\n- ü§© Instala√ß√£o Gr√°tis\n- üòç Super Wi-Fi 5Ghz incluso\nüöÄ *Ideal para gamers, streamers e multitarefas que n√£o podem ficar sem velocidade.*\n\n- Possui fidelidade de 12 meses",
                "üöÄ *Plano 1 GIGA Fibramar*\n*1 GIGA ‚Ä¢ R$ 149,99/m√™s* (pagando at√© o vencimento)\n*R$ 169,99/m√™s* (ap√≥s vencimento)\n\n- Wi-Fi 6 incluso\n- 100% Fibra √ìptica\n- ü§© Instala√ß√£o Gr√°tis\n\n‚ö°Ô∏è* Ideal para gamers, streamers e multitarefas que n√£o podem ficar sem velocidade.*\n\nüîó Opcional: Repetidor Mesh por apenas R$ 29,99/m√™s\n\n- Possui fidelidade de 12 meses",
                "Qual dessas op√ß√µes encaixa melhor para voc√™? Vamos realizar o cadastro agora? üß°",
                "üì¢ PLANOS DE INTERNET M√ìVEL FIBRAMAR üì¢\n\nEscolha o pacote ideal para o seu dia a dia üëá\n\nüí† 1 GIGA ‚Äì R$ 24,99\nüí† 2 GIGA ‚Äì R$ 29,99\nüí† 5 GIGA ‚Äì R$ 32,99\nüí† 10 GIGA ‚Äì R$ 39,99\nüí† 15 GIGA ‚Äì R$ 49,99\nüí† 20 GIGA ‚Äì R$ 52,99\nüí† 24 GIGA ‚Äì R$ 54,99\nüí† 30 GIGA ‚Äì R$ 64,99\nüí† 35 GIGA ‚Äì R$ 69,99\nüí† 50 GIGA ‚Äì R$ 84,99\nüí† 80 GIGA ‚Äì R$ 129,99\n\n‚úÖ WhatsApp Ilimitado\n‚úÖ Liga√ß√µes Ilimitadas\n‚úÖ Portabilidade dispon√≠vel",
                "*Voc√™ gostaria de incluir algum servi√ßo adicional para deixar sua experi√™ncia ainda melhor*‚ùì\n\nCada servi√ßo adicional √© R$: 14,99 adicional na mensalidade \n\n- *McAfee* ‚Äì Prote√ß√£o antiv√≠rus\n- *MediQuo* ‚Äì Assist√™ncia m√©dica 24h por teleconsulta\n- *Qualifica* ‚Äì Cursos online com certificado\n- *Paramount+* ‚Äì Filmes e s√©ries premium\n- *Watch* ‚Äì Conte√∫do de streaming variado\n- *Nick Jr.* ‚Äì Conte√∫dos educativos para crian√ßas",
            ],
            "üìã CADASTRO DE NOVO CLIENTE": [
                "Promo√ß√£o: Instala√ß√£o GR√ÅTIS por tempo limitado (com a fidelidade de 12 meses).\n\n### Para iniciar o cadastro, envie os dados:\n\nNome completo:\nCPF:\nRG:\nData de nascimento:\nE-mail:\nPlano desejado:\nData de vencimento (3, 7 ou 12):\nTelefone(s):\nEndere√ßo completo:\nCEP:\nRefer√™ncia visual (ponto de refer√™ncia pr√≥ximo):\nGostaria da fidelidade de 12 meses?\nData e per√≠odo para a instala√ß√£o:\nPor onde conheceu a empresa ?\n\nAgradecemos por escolher a *FIBRAMAR*! üß°",
                "‚úÖ Cadastro conclu√≠do com sucesso.\n\nüîß Instala√ß√£o agendada para o dia [data].\n\nPosso ajudar em algo mais ou podemos finalizar seu atendimento?",
                "Dados para cadastro do chip\n\n**DADOS PESSOAIS:**\nCPF/CNPJ:\nNome Completo:\nE-mail:\nData de nascimento:\nTelefone alternativo:\n\n**ENDERE√áO:**\nCEP:\nUF:\nCidade:\nEndere√ßo:\nN√∫mero:\nBairro:\nComplemento:\nRefer√™ncia (Opcional):\n\n**DADOS DO CHIP:**\nN√∫mero do Chip:\nDDD:\nPlano:\nPortabilidade: ( ) SIM ou ( ) N√ÉO\nForma de Pagamento:\n\nAgradecemos por escolher a *FIBRAMAR*! üß°",
                "‚úÖ Cadastro do chip conclu√≠do com sucesso.\n\nüì± Ativa√ß√£o ser√° processada apos o pagamento.\n\nPosso ajudar em algo mais ou podemos finalizar seu atendimento?",
                "Sobre os boletos, o primeiro m√™s √© proporcional aos dias utilizados, podendo vir um pouco mais ou um pouco menos, dependendo do vencimento.\nO sistema gera automaticamente esse proporcional, n√£o temos como saber quanto ser√°.\nPode ser que ele gere pro mesmo m√™s e chegue um valor pequeno, ou, pode gerar pro m√™s seguinte e juntar com a mensalidade. Por√©m, isso √© apenas no primeiro m√™s, devido ao proporcional.\nDe segundo m√™s em diante as faturas chegam normais.\nOs boletos s√£o enviados para o email do cadastro. Tamb√©m ficam dispon√≠veis na central do assinante ou em nosso aplicativo. (https://crnetfibramar.com.br/central_assinante_web/login)",

            ],
            "üñ•Ô∏è CONFIGURA√á√ÉO DO ROTEADOR": [
                "Conecte-se ao Wi-Fi\n\nDesligue os dados m√≥veis\n\n**Me envie uma foto da etiqueta na parte de baixo do seu roteador.** (O IP, Login e Senha podem estar l√°)\n",
                "Acesse no navegador: **192.168.1.1**\n\nSe poss√≠vel, envie print da tela."
            ],
            "üîß SUPORTE / PROCEDIMENTOS": [
                "H√° alguma luz piscando ou com cor diferente no equipamento?",
                "Desligue o aparelho por 5 minutos, religue e me informe.",
                "Nosso atendimento n√£o reconhece √°udios, apenas mensagens de texto.",
                "Para realizar a transfer√™ncia do equipamento da FIBRAMAR para um novo endere√ßo: ‚ö†Ô∏è Taxa: R$ 50,00. Confirme os dados abaixo: \n Nome completo \n CPF \n RG \nNovo endere√ßo \n CEP \n Refer√™ncia \nTelefone de contato \nAp√≥s a confirma√ß√£o, agendaremos a transfer√™ncia.",
                "Verifiquei que h√° uma redu√ß√£o em sua rede, devido a um boleto em aberto do vencimento (//)  se recorda de ter efetuado o pagamento?",
                "Foi aberto um suporte t√©cnico para verificar, o prazo m√°ximo do atendimento √© de at√© 48 horas, por√©m a visita t√©cnica pode acontecer a qualquer momento!\n\nOriento algo mais?",
                "Poderia desligar e ligar o roteador e assim que se conectar novamente, realizar um teste de velocidade no link abaixo? https://fast.com/pt/ Assim que concluir, me envie um print.",
                "Seu pedido j√° se encontra com o t√©cnico e antes de ir, o mesmo pode entrar em contato com o senhor para saber se possui algu√©m na resid√™ncia para receb√™-lo. Oriento em algo mais?",
                "Verifiquei que possui um pedido de visita t√©cnica em aberto no sistema no dia (/), o t√©cnico tem o prazo de at√© 48 horas para realizar o reparo, no caso at√© as 18h de (/). Oriento em algo mais?",
                "Verifiquei este pedido de visita t√©cnica aberto no dia (/), aonde o prazo de 48 horas se encerrou no dia (/). Portanto irei entrar em contato com o supervisor dos t√©cnicos, solicitando que ele v√° o quanto antes de forma priorit√°ria  realizar o reparo, oriento em algo mais?",
                "Infelizmente o setor respons√°vel por esse assunto s√≥ est√° dispon√≠vel para o atendimento dentro do hor√°rio comercial de segunda a sexta, das 8:00 √°s 18:00 e aos s√°bados das 8:00 √°s 17:00. Poderia entrar em contato dentro desse hor√°rio para verificarmos o seu boleto e atualizarmos para a senhor (a)?",
                "Um roteador normal o m√°ximo que passa via wi-fi √© 50 Mb, porque o roteador √© limitado, por isso o cliente tem que ter um roteador GIGA, configura√ß√£o AC 1200, pois esse roteador ele passa acima de 50 Mb via wi-fi, mas tamb√©m vai depender dos aparelhos que possui se rodam a velocidade acima de 50 Mb.",
                
            ],
            "üìë PADR√ÉO DE ABERTURA DE O.S": [
                "CLIENTE SEM CONEX√ÉO, FEITO OS PROCEDIMENTOS PADR√ïES E N√ÉO RETORNOU\nPOT√äNCIA DA ONU: OFF\n√öLTIMA CONEX√ÉO: 1 HORA\nLOS VERMELHA: SIM\nTAG :\n[NOME_ATENDENTE] - [DATA] - [HORA]",
                "CLIENTE RELATA LENTID√ÉO, FEITO OS PROCEDIMENTOS PADR√ïES SEM SUCESSO.\nTESTE DE VELOCIDADE:\nDOWNLOAD:  Mbps\nUPLOAD:  Mbps\nAPARELHO: \nPOT√äNCIA DA ONU: \nTAG :\n\n[NOME_ATENDENTE] - [DATA] - [HORA]",
                "INSTALA√á√ÉO GRATUITA\n\nINSTALA√á√ÉO SER√Å GRATUITA NA PROMO√á√ÉO DO CARLOS\n\nPLANO DE / COM ROTEADOR EM COMODATO\n\nDATA DE VENCIMENTO: 12\n\nCONSULTORA(O): [NOME_ATENDENTE]\n\nCONTATO FEITO COM A CLIENTE A MESMA AGUARDA INSTALA√á√ÉO PARA O DIA\n\nCLIENTE CIENTE QUE PRECISA REALIZAR A ASSINATURA DO CONTRATO NA CENTRAL DO ASSINANTE",
                "INSTALA√á√ÉO PAGA\n\nINSTALA√á√ÉO SER√Å PAGA NO VALOR DE R$\n\nPLANO DE / R$ COM ROTEADOR EM COMODATO\n\nDATA DE VENCIMENTO:\n\nCONSULTORA(O): [NOME_ATENDENTE]\n\nCONTATO FEITO COM A CLIENTE A MESMA AGUARDA INSTALA√á√ÉO PARA O DIA //\n\nCLIENTE CIENTE QUE PRECISA REALIZAR A ASSINATURA DO CONTRATO NA CENTRAL DO ASSINANTE",
                "Atendente: [NOME_ATENDENTE] | Data: [DATA] | Hora: [HORA]"
            ],
            "üìù TERMO DE RESPONSABILIDADE": [
                "Para quem usa equipamento pr√≥prio:\n\nüîó https://app.zapsign.com.br/verificar/doc/2794e63d-905c-4cb0-8c5e-7b22226901c3"
            ],
            "‚ùå CANCELAMENTO": [
                "Por favor, envie os dados abaixo:\n\n- Nome completo:\n- CPF:\n- RG:\n- Endere√ßo completo:\n- Motivo do cancelamento:\n\nAssim que recebermos as informa√ß√µes, abriremos a solicita√ß√£o no sistema.\n\nDentro de 72 horas √∫teis, o setor respons√°vel entrar√° em contato para finalizar o equipamento e caso houver equipamento agendar a retirada dos equipamentos.",
                "üí∏ PROPORCIONAL (Quebra de contrato)\n\nConforme fidelidade de 12 meses, o valor de R$ 360,00 da instala√ß√£o √© proporcional:\n\nR$ 30,00 x [meses restantes] = R$ [valor final]",
                "Ol√°! Para que possamos ajudar da melhor forma, voc√™ poderia nos informar se deseja fazer alguma altera√ß√£o no plano ou cancelar o servi√ßo?",
                "Podemos enviar um t√©cnico hoje para verificar e resolver qualquer problema com o seu servi√ßo.",
                "Se preferir, podemos enviar o supervisor dos t√©cnicos para acompanhar a visita e garantir que tudo seja resolvido.",
                "Antes de qualquer decis√£o, podemos avaliar alternativas ou ajustes no servi√ßo que possam melhorar sua experi√™ncia.",
                "Outra alternativa √© realizar a troca de titularidade do plano, caso deseje que outra pessoa assuma o servi√ßo.",
                "Tamb√©m √© poss√≠vel transferir o servi√ßo para outro endere√ßo, mantendo seu plano ativo sem interrup√ß√µes.",
            ],
            "üí≤ PRE√áOS E TAXAS": [
                "- Instala√ß√£o: R$ 360,00\n- Visita improdutiva: R$ 30,00\n- Conector: R$ 10,00\n- 1 metro de fibra: R$ 0,60"
            ],
            "üìâ DESCONTO": [
                "Para solicitar desconto, envie um e-mail com:\n\n- Nome completo:\n- CPF:\n- Telefone:\n- Motivo:\n- Endere√ßo:\n- Dias afetados:\n\ndesconto@crnetfibramar.com.br"
            ],
            "üìç ENDERE√áOS DAS LOJAS": [
                "CENTRO - MARIC√Å\n\nAVENIDA VEREADOR FRANCISCO SABINO DA COSTA N¬∞ 78- NO SHOPPING CENTER 1 - T√âRREO\n\nEM FRENTE A CASA E VIDEO, DE ESQUINA COM O RESTAURANTE JOAO E JOAO",
                "CORDEIRINHO - MARIC√Å\n\nAVENIDA MAYSA 6391 LT 07 QD 120-CORDEIRINHO\n\nESQUINA A RUA 90 NA PRINCIPAL, DO LADO DO HORTIFRUTI DA 90",
                "ITAIPUA√áU - MARIC√Å\n\nRUA 01 LT 31 QD 04 LOJA 03- ITAIPUA√áU\nPERTO DA RUA 34 EM FRENTE A PADARIA",
                "LOJA S√ÉO JOS√â - MARIC√Å\n\nAVENIDA ELOMIR GON√áALVES DA SILVA N¬∞ 15-S√ÉO JOSE DO IMBASSAI\n\nEM FRENTE A CASA DE RA√á√ÉO ARAKEN",
                "Loja de Jacone\n\nEndere√ßo: R. 13, 2020 - Loja 5 - Jacon√©, Saquarema - RJ, 28998-872\n\nRefer√™ncia: De esquina com a rua 96.",
                "Loja de Muqui\n\nRua Coronel Luiz Carlos n333, Muqui, ES, 29480-000\n\nRefer√™ncia: Em frente ao Banco Cresol",
                "Loja de Mimoso do Sul\n\nRua Dr Jose Monteiro n11 , Centro. Mimoso do Sul, ES, 29400-000\n\nRefer√™ncia: Ao lado do F√≥rum.",
                "Loja Unamar\n\nRua das pacas ; Gravata 02 - Unamar, Cabo Frio, RJ,\n\nCEP: 28927503\n\nReferencia: Em frente ao Mercado Rende Pacas."
            ],
            "üì≤ WHATSAPP E LINKS √öTEIS": [
                "WhatsApp Atendimento:\n\nüîó https://api.whatsapp.com/send/?phone=5508001003850",
                "Central do Assinante (IXC):\n\nüîó https://crnetfibramar.com.br/",
                "LinkTree com acessos e apps:\n\nüîó https://linktr.ee/fibramarinternet"
            ],
            "üîë SENHAS PADR√ïES": {
                "type": "passwords",
                "items": [
                    {
                        "title": "ACESSO REMOTO",
                        "credentials": [
                            { "user": "user", "password": "RooT@fibramaR_" }
                        ]
                    },
                    {
                        "title": "CIANET\\VSOL",
                        "credentials": [
                            { "user": "", "password": "adminisp" },
                        ]
                    },
                    {
                        "title": "Multilaser ZTE",
                        "credentials": [
                            { "user": "", "password": "Multipro" },
                            { "user": "", "password": "multipro" }
                        ]
                    },
                    {
                        "title": "Configura√ß√µes Padr√£o",
                        "credentials": [
                            { "user": "SSID", "password": "Contactar a Fibramar 08001003850" },
                            { "user": "Senha WiFi", "password": "fibramar@2025" },
                            { "user": "Login PPPoE", "password": "equipamento.resetado" },
                            { "user": "Vlan", "password": "4000" },
                            { "user": "IP de entrada", "password": "192.168.99.1" }
                        ]
                    },
                    {
                        "title": "ONT TP-Link resetada",
                        "credentials": []
                    },
                    {
                        "title": "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê",
                        "credentials": ["CastroX"]
                    },
                    {
                        "title": "üìç S√ÉO PAULO",
                        "credentials": []
                    },
                    {
                        "title": "RAISECOM - 192.168.1.1",
                        "credentials": [
                            { "user": "Login", "password": "superadmin" },
                            { "user": "Senha", "password": "q!w@e#" }
                        ]
                    },
                    {
                        "title": "ONT DATACOM - 192.168.1.1",
                        "credentials": [
                            { "user": "Login", "password": "support" },
                            { "user": "Senha", "password": "support" }
                        ]
                    },
                    {
                        "title": "ONT FIBRACOM CHIMA - 192.168.86.1",
                        "credentials": [
                            { "user": "Login", "password": "telecomadmin" },
                            { "user": "Senha", "password": "cHI*mA868#558" }
                        ]
                    },
                    {
                        "title": "ONT EASY 4 LINK - 192.168.1.1",
                        "credentials": [
                            { "user": "Login", "password": "admin" },
                            { "user": "Senha", "password": "1234" }
                        ]
                    },
                    {
                        "title": "ROTEADOR MERCUSYS - mwlogin.net",
                        "credentials": [
                            { "user": "Login (padr√£o)", "password": "admin" },
                            { "user": "Senha (padr√£o)", "password": "admin1" },
                            { "user": "Alternativa 1: Login e Senha", "password": "admin1" },
                            { "user": "Alternativa 2: Login e Senha", "password": "admin" }
                        ]
                    },
                    {
                        "title": "ROTEADOR DLINK - 192.168.0.1",
                        "credentials": [
                            { "user": "Login", "password": "admin" },
                            { "user": "Senha", "password": "admin1" }
                        ]
                    },
                    {
                        "title": "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê",
                        "credentials": []
                    },
                    {
                        "title": "üìç MARIC√Å",
                        "credentials": []
                    },
                    {
                        "title": "Wellington",
                        "credentials": [
                            { "user": "Senha", "password": "admin1" }
                        ]
                    },
                    {
                        "title": "Felipe Costa",
                        "credentials": [
                            { "user": "Senha", "password": "admin1" }
                        ]
                    },
                    {
                        "title": "Luiz Felipe",
                        "credentials": [
                            { "user": "Senha", "password": "admin1 / Admin1@@" }
                        ]
                    },
                    {
                        "title": "Guilherme",
                        "credentials": [
                            { "user": "Senha", "password": "password@" }
                        ]
                    },
                    {
                        "title": "Diogo",
                        "credentials": [
                            { "user": "Senha", "password": "admin1 / admin@ / password1 / password@ / RooT@fibramaR_" }
                        ]
                    },
                    {
                        "title": "Luiz Fernando",
                        "credentials": [
                            { "user": "Senha", "password": "password@ / Password@ / Admin1 / Admin@" }
                        ]
                    },
                    {
                        "title": "Sidney",
                        "credentials": [
                            { "user": "Senha", "password": "admin1" }
                        ]
                    },
                    {
                        "title": "Edvan",
                        "credentials": [
                            { "user": "Senha", "password": "admin@123" }
                        ]
                    },
                    {
                        "title": "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê",
                        "credentials": []
                    },
                    {
                        "title": "üìç SAQUAREMA",
                        "credentials": []
                    },
                    {
                        "title": "Lucas",
                        "credentials": [
                            { "user": "Senha", "password": "12345678a" }
                        ]
                    },
                    {
                        "title": "Ivan Carlos",
                        "credentials": [
                            { "user": "Senha", "password": "12345678a / Epadim / adminEp / telecomadmin / admintelecom" }
                        ]
                    },
                    {
                        "title": "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê",
                        "credentials": []
                    },
                    {
                        "title": "üìç VILA VELHA",
                        "credentials": []
                    },
                    {
                        "title": "Informa√ß√£o",
                        "credentials": [
                            { "user": "", "password": "(Entre em contato com o Bruno, que ele faz atrav√©s do acesso remoto.)" },
                            { "user": "", "password": "Fibr@mar2022" },
                            { "user": "", "password": "admin" },
                            { "user": "", "password": "user" }
                        ]
                    },
                    {
                        "title": "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê",
                        "credentials": []
                    },
                    {
                        "title": "üìç MUQUI / MIMOSO DO SUL",
                        "credentials": []
                    },
                    {
                        "title": "Uilas",
                        "credentials": [
                            { "user": "Senha", "password": "admin / Ab12345@" }
                        ]
                    },
                    {
                        "title": "Rabel",
                        "credentials": [
                            { "user": "Senha", "password": "admin" }
                        ]
                    },
                    {
                        "title": "Samuel - ONT",
                        "credentials": [
                            { "user": "Senha", "password": "Ab12345@" }
                        ]
                    },
                    {
                        "title": "Samuel - Huawei",
                        "credentials": [
                            { "user": "Senha", "password": "Coloca admin em cima embaixo colocar a senha que o cliente tinha escolhido" }
                        ]
                    },
                    {
                        "title": "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê",
                        "credentials": []
                    },
                    {
                        "title": "üìç SANTOS DUMONT",
                        "credentials": []
                    },
                    {
                        "title": "Senha padr√£o",
                        "credentials": [
                            { "user": "Senha", "password": "Fibramar.25" }
                        ]
                    }
                ]
            },
            "‚öôÔ∏è HABILITANDO ONU": [
                "HABILITAR > SALVAR > DEPOIS GRAVAR\n\nDESABILITAR > EXCLUIR > DELETAR",
                "OLT  (MARIC√Å)\n\nQUALQUER ONU - 7",
                "OLT (ITAIPUA√áU)\n\nBRIDGE - 62\nROUTER - 53\nBRIDGE PRETA PEQUENA - 74",
                "OLT  PARA ONU HUAWEI (JACON√â)\n\nQUALQUER ONU - 7",
                "OLT (VILA VELHA) (ES)\n\nONUs ZTE - Perfil 85\nONUs outras marcas - 86",
                "OLT (UNAMAR/ARARUAMA)\n\n ONUs Pista- Perfil 9 \n ONUs Condominio - 81 ",
            ]
        };

        // Tema
        const themeToggle = document.getElementById('themeToggle');
        const themeIcon = document.getElementById('themeIcon');
        const themeText = document.getElementById('themeText');
        const body = document.body;

        // Carregar tema salvo
        const savedTheme = localStorage.getItem('theme') || 'light';
        if (savedTheme === 'dark') {
            body.classList.add('dark-mode');
            themeIcon.textContent = '‚òÄÔ∏è';
            themeText.textContent = 'Light';
        }

        // Alternar tema
        themeToggle.addEventListener('click', () => {
            body.classList.toggle('dark-mode');
            
            if (body.classList.contains('dark-mode')) {
                themeIcon.textContent = '‚òÄÔ∏è';
                themeText.textContent = 'Light';
                localStorage.setItem('theme', 'dark');
            } else {
                themeIcon.textContent = 'üåô';
                themeText.textContent = 'Dark';
                localStorage.setItem('theme', 'light');
            }
        });

        // Renderizar t√≥picos
        function renderTopics(data = scriptData, searchTerm = '') {
            const topicsContainer = document.getElementById('topics');
            topicsContainer.innerHTML = '';

            for (const [topicName, content] of Object.entries(data)) {
                // Verificar se √© o t√≥pico de senhas com estrutura especial
                if (content.type === 'passwords') {
                    renderPasswordTopic(topicName, content, searchTerm);
                    continue;
                }

                const messages = content;
                
                // Filtrar mensagens se houver termo de busca
                let filteredMessages = messages;
                if (searchTerm) {
                    filteredMessages = messages.filter(msg => 
                        msg.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        topicName.toLowerCase().includes(searchTerm.toLowerCase())
                    );
                    
                    // Pular t√≥pico se n√£o houver mensagens correspondentes
                    if (filteredMessages.length === 0) continue;
                }

                const topicDiv = document.createElement('div');
                topicDiv.className = 'topic';

                const topicHeader = document.createElement('div');
                topicHeader.className = 'topic-header';
                topicHeader.innerHTML = `
                    <h2>${topicName}</h2>
                    <span class="topic-icon">‚ñº</span>
                `;

                const messagesDiv = document.createElement('div');
                messagesDiv.className = 'messages';

                filteredMessages.forEach(message => {
                    const messageItem = document.createElement('div');
                    messageItem.className = 'message-item';
                    
                    const messageText = document.createElement('div');
                    messageText.className = 'message-text';
                    messageText.textContent = message;
                    
                    messageItem.appendChild(messageText);
                    messageItem.addEventListener('click', () => copyToClipboard(message));
                    
                    messagesDiv.appendChild(messageItem);
                });

                topicHeader.addEventListener('click', () => {
                    topicDiv.classList.toggle('active');
                });

                topicDiv.appendChild(topicHeader);
                topicDiv.appendChild(messagesDiv);
                topicsContainer.appendChild(topicDiv);
            }
        }

        // Renderizar t√≥pico de senhas com estrutura especial
        function renderPasswordTopic(topicName, content, searchTerm) {
            const topicsContainer = document.getElementById('topics');
            
            const topicDiv = document.createElement('div');
            topicDiv.className = 'topic';

            const topicHeader = document.createElement('div');
            topicHeader.className = 'topic-header';
            topicHeader.innerHTML = `
                <h2>${topicName}</h2>
                <span class="topic-icon">‚ñº</span>
            `;

            const messagesDiv = document.createElement('div');
            messagesDiv.className = 'messages';

            content.items.forEach(item => {
                if (searchTerm) {
                    const matchesSearch = item.title.toLowerCase().includes(searchTerm.toLowerCase()) ||
                        item.credentials.some(cred => 
                            cred.user.toLowerCase().includes(searchTerm.toLowerCase()) ||
                            cred.password.toLowerCase().includes(searchTerm.toLowerCase())
                        );
                    if (!matchesSearch) return;
                }

                // Criar grupo de credenciais
                const groupDiv = document.createElement('div');
                groupDiv.style.marginBottom = '15px';

                // T√≠tulo do grupo
                if (item.title) {
                    const titleDiv = document.createElement('div');
                    titleDiv.style.fontWeight = 'bold';
                    titleDiv.style.marginBottom = '8px';
                    titleDiv.style.color = body.classList.contains('dark-mode') ? '#a78bfa' : '#667eea';
                    titleDiv.textContent = item.title;
                    groupDiv.appendChild(titleDiv);
                }

                // Credenciais
                item.credentials.forEach(cred => {
                    const credDiv = document.createElement('div');
                    credDiv.className = 'message-item password-item';
                    credDiv.style.display = 'flex';
                    credDiv.style.justifyContent = 'space-between';
                    credDiv.style.alignItems = 'center';
                    credDiv.style.padding = '10px 15px';

                    const userSpan = document.createElement('span');
                    userSpan.style.fontWeight = '500';
                    userSpan.style.color = body.classList.contains('dark-mode') ? '#b0b0b0' : '#666';
                    userSpan.textContent = cred.user || '‚Äî';

                    const passwordSpan = document.createElement('span');
                    passwordSpan.style.fontFamily = 'monospace';
                    passwordSpan.style.fontWeight = 'bold';
                    passwordSpan.style.color = body.classList.contains('dark-mode') ? '#e0e0e0' : '#333';
                    passwordSpan.style.cursor = 'pointer';
                    passwordSpan.textContent = cred.password;

                    credDiv.appendChild(userSpan);
                    credDiv.appendChild(passwordSpan);

                    // Copiar apenas a senha ao clicar
                    credDiv.addEventListener('click', (e) => {
                        e.stopPropagation();
                        copyToClipboard(cred.password);
                    });

                    groupDiv.appendChild(credDiv);
                });

                messagesDiv.appendChild(groupDiv);
            });

            topicHeader.addEventListener('click', () => {
                topicDiv.classList.toggle('active');
            });

            topicDiv.appendChild(topicHeader);
            topicDiv.appendChild(messagesDiv);
            topicsContainer.appendChild(topicDiv);
        }

        // --- Substitui vari√°veis e adiciona sauda√ß√£o autom√°tica ---
        function replaceVariables(text) {
            const attendantName = document.getElementById('attendantName').value || '';
            const now = new Date();
            const dia = String(now.getDate()).padStart(2, '0');
            const mes = String(now.getMonth() + 1).padStart(2, '0');
            const ano = String(now.getFullYear()).slice(-2);
            const hora = String(now.getHours()).padStart(2, '0');
            const minuto = String(now.getMinutes()).padStart(2, '0');

            const dataAtual = `${dia}/${mes}/${ano}`;
            const horaAtual = `${hora}:${minuto}`;

            // Sauda√ß√£o autom√°tica conforme o hor√°rio
            let periodo = "";
            const horaNum = now.getHours();
            if (horaNum >= 5 && horaNum < 12) {
                periodo = "Bom dia";
            } else if (horaNum >= 12 && horaNum < 18) {
                periodo = "Boa tarde";
            } else {
                periodo = "Boa noite";
            }

            return text
                .replace(/\[PERIODO\]/g, periodo)
                .replace(/\[NOME_ATENDENTE\]/g, attendantName)
                .replace(/\[DATA\]/g, dataAtual)
                .replace(/\[HORA\]/g, horaAtual);
        }

        // Copiar para √°rea de transfer√™ncia
        function copyToClipboard(text) {
            const textAtualizado = replaceVariables(text);
            
            navigator.clipboard.writeText(textAtualizado).then(() => {
                showNotification();
            }).catch(err => {
                console.error('Erro ao copiar:', err);
            });
        }

        // Mostrar notifica√ß√£o
        function showNotification() {
            const notification = document.getElementById('notification');
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 2000);
        }

        // Busca
        const searchInput = document.getElementById('searchInput');
        searchInput.addEventListener('input', (e) => {
            const searchTerm = e.target.value;
            renderTopics(scriptData, searchTerm);
        });

        // Renderizar inicialmente
        renderTopics();

        // Atualizar vari√°veis quando o nome do atendente for alterado
        const attendantNameInput = document.getElementById('attendantName');
        
        // Carregar nome do atendente salvo
        const savedAttendantName = localStorage.getItem('attendantName');
        if (savedAttendantName) {
            attendantNameInput.value = savedAttendantName;
        }
        
        attendantNameInput.addEventListener('input', function() {
            // Salvar nome do atendente no localStorage
            localStorage.setItem('attendantName', attendantNameInput.value);
            // Re-renderizar todos os t√≥picos com as vari√°veis atualizadas
            renderTopics();
        });

        // Bloco de Notas
        const notepad = document.getElementById('notepad');
        const notepadToggle = document.getElementById('notepadToggle');
        const notepadClose = document.getElementById('notepadClose');
        const notepadReopen = document.getElementById('notepadReopen');
        const notepadTextarea = document.getElementById('notepadTextarea');
        const notepadClear = document.getElementById('notepadClear');
        const charCount = document.getElementById('charCount');

        // Carregar notas salvas
        const savedNotes = localStorage.getItem('notepadContent');
        if (savedNotes) {
            notepadTextarea.value = savedNotes;
            updateCharCount();
        }

        // Carregar estado do bloco de notas
        const notepadHidden = localStorage.getItem('notepadHidden') === 'true';
        if (notepadHidden) {
            notepad.classList.add('hidden');
            notepadReopen.classList.add('show');
            body.classList.add('notepad-hidden');
        }

        // Minimizar/Maximizar
        notepadToggle.addEventListener('click', (e) => {
            e.stopPropagation();
            notepad.classList.toggle('minimized');
            notepadToggle.textContent = notepad.classList.contains('minimized') ? '+' : '‚àí';
        });

        // Fechar bloco de notas
        notepadClose.addEventListener('click', (e) => {
            e.stopPropagation();
            notepad.classList.add('hidden');
            notepadReopen.classList.add('show');
            body.classList.add('notepad-hidden');
            localStorage.setItem('notepadHidden', 'true');
        });

        // Reabrir bloco de notas
        notepadReopen.addEventListener('click', () => {
            notepad.classList.remove('hidden');
            notepadReopen.classList.remove('show');
            body.classList.remove('notepad-hidden');
            localStorage.setItem('notepadHidden', 'false');
        });

        // Salvar automaticamente
        notepadTextarea.addEventListener('input', () => {
            localStorage.setItem('notepadContent', notepadTextarea.value);
            updateCharCount();
        });

        // Limpar notas
        notepadClear.addEventListener('click', () => {
            if (confirm('Tem certeza que deseja limpar todas as anota√ß√µes?')) {
                notepadTextarea.value = '';
                localStorage.removeItem('notepadContent');
                updateCharCount();
            }
        });

        // Exportar notas
        const notepadExport = document.getElementById('notepadExport');
        notepadExport.addEventListener('click', () => {
            const content = notepadTextarea.value;
            if (!content.trim()) {
                alert('N√£o h√° conte√∫do para exportar!');
                return;
            }
            
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            const now = new Date();
            const filename = `notas-atendimento-${now.getFullYear()}${String(now.getMonth()+1).padStart(2,'0')}${String(now.getDate()).padStart(2,'0')}-${String(now.getHours()).padStart(2,'0')}${String(now.getMinutes()).padStart(2,'0')}.txt`;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('‚úì Notas exportadas com sucesso!');
        });

        // Importar notas
        const notepadImportBtn = document.getElementById('notepadImportBtn');
        const notepadImport = document.getElementById('notepadImport');
        
        notepadImportBtn.addEventListener('click', () => {
            notepadImport.click();
        });

        notepadImport.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = (event) => {
                const content = event.target.result;
                if (notepadTextarea.value.trim() && !confirm('Deseja substituir o conte√∫do atual?')) {
                    notepadImport.value = '';
                    return;
                }
                notepadTextarea.value = content;
                localStorage.setItem('notepadContent', content);
                updateCharCount();
                showNotification('‚úì Notas importadas com sucesso!');
                notepadImport.value = '';
            };
            reader.readAsText(file);
        });

        // Atualizar contador de caracteres
        function updateCharCount() {
            const count = notepadTextarea.value.length;
            charCount.textContent = `${count} caractere${count !== 1 ? 's' : ''}`;
        }

        // Sistema de corre√ß√£o ortogr√°fica removido
        // (Funcionalidade removida devido √† complexidade de implementa√ß√£o adequada)

        // Calculadora Financeira (Modal)
        const calculatorBackdrop = document.getElementById('calculatorBackdrop');
        const calculatorOpenBtn = document.getElementById('calculatorOpenBtn');
        const calculatorClose = document.getElementById('calculatorClose');

        console.log('Calculator elements:', {
            backdrop: calculatorBackdrop,
            openBtn: calculatorOpenBtn,
            closeBtn: calculatorClose
        });

        // Abrir calculadora
        if (calculatorOpenBtn) {
            calculatorOpenBtn.addEventListener('click', () => {
                console.log('Bot√£o clicado!');
                calculatorBackdrop.classList.add('show');
            });
        } else {
            console.error('Bot√£o da calculadora n√£o encontrado!');
        }

        // Fechar calculadora
        calculatorClose.addEventListener('click', () => {
            calculatorBackdrop.classList.remove('show');
        });

        // Fechar ao clicar no backdrop
        calculatorBackdrop.addEventListener('click', (e) => {
            if (e.target === calculatorBackdrop) {
                calculatorBackdrop.classList.remove('show');
            }
        });

        // Fechar com tecla ESC
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && calculatorBackdrop.classList.contains('show')) {
                calculatorBackdrop.classList.remove('show');
            }
        });

        // C√°lculo Proporcional
        const calcProporcionalBtn = document.getElementById('calcProporcional');
        const valorPlanoInput = document.getElementById('valorPlano');
        const diasMesInput = document.getElementById('diasMes');
        const diasUtilizadosInput = document.getElementById('diasUtilizados');
        const resultProporcional = document.getElementById('resultProporcional');
        const valorProporcionalSpan = document.getElementById('valorProporcional');

        calcProporcionalBtn.addEventListener('click', () => {
            const valorPlano = parseFloat(valorPlanoInput.value);
            const diasMes = parseInt(diasMesInput.value);
            const diasUtilizados = parseInt(diasUtilizadosInput.value);

            if (!valorPlano || !diasMes || diasUtilizados === undefined) {
                alert('Por favor, preencha todos os campos do c√°lculo proporcional.');
                return;
            }

            if (diasUtilizados > diasMes) {
                alert('Dias utilizados n√£o pode ser maior que dias do m√™s.');
                return;
            }

            const valorProporcional = (valorPlano / diasMes) * diasUtilizados;
            valorProporcionalSpan.textContent = `R$ ${valorProporcional.toFixed(2).replace('.', ',')}`;
            resultProporcional.classList.add('show');
        });

        // C√°lculo de Acordo (1 fatura e meia)
        const calcAcordoBtn = document.getElementById('calcAcordo');
        const valorFaturaInput = document.getElementById('valorFatura');
        const resultAcordo = document.getElementById('resultAcordo');
        const valorAcordoSpan = document.getElementById('valorAcordo');

        calcAcordoBtn.addEventListener('click', () => {
            const valorFatura = parseFloat(valorFaturaInput.value);

            if (!valorFatura) {
                alert('Por favor, informe o valor da fatura.');
                return;
            }

            const valorAcordo = valorFatura * 1.5;
            valorAcordoSpan.textContent = `R$ ${valorAcordo.toFixed(2).replace('.', ',')}`;
            resultAcordo.classList.add('show');
        });

        // C√°lculo de Comiss√£o
        const calcComissaoBtn = document.getElementById('calcComissao');
        const qtdCadastrosInput = document.getElementById('qtdCadastros');
        const valorAcordosInput = document.getElementById('valorAcordos');
        const resultComissao = document.getElementById('resultComissao');
        const valorComissaoSpan = document.getElementById('valorComissao');
        const detalhesComissao = document.getElementById('detalhesComissao');

        calcComissaoBtn.addEventListener('click', () => {
            const qtdCadastros = parseInt(qtdCadastrosInput.value) || 0;
            const valorAcordos = parseFloat(valorAcordosInput.value) || 0;

            // R$ 3,00 por cadastro + metade do valor dos acordos
            const comissaoCadastros = qtdCadastros * 3;
            const comissaoAcordos = valorAcordos / 2;
            const comissaoTotal = comissaoCadastros + comissaoAcordos;

            valorComissaoSpan.textContent = `R$ ${comissaoTotal.toFixed(2).replace('.', ',')}`;
            detalhesComissao.innerHTML = `
                Cadastros: ${qtdCadastros} √ó R$ 3,00 = R$ ${comissaoCadastros.toFixed(2).replace('.', ',')}<br>
                Acordos: R$ ${valorAcordos.toFixed(2).replace('.', ',')} √∑ 2 = R$ ${comissaoAcordos.toFixed(2).replace('.', ',')}
            `;
            resultComissao.classList.add('show');
        });

        // Formatar inputs para aceitar v√≠rgula como decimal
        [valorPlanoInput, valorFaturaInput, valorAcordosInput].forEach(input => {
            input.addEventListener('input', (e) => {
                let value = e.target.value.replace(',', '.');
                e.target.value = value;
            });
        });

        // Widget de Data/Hora
        const datetimeWidget = document.getElementById('datetimeWidget');
        const weatherWidget = document.getElementById('weatherWidget');
        
        // Verificar se os widgets existem
        if (!datetimeWidget) {
            console.error('Widget de data/hora n√£o encontrado');
        }
        if (!weatherWidget) {
            console.error('Widget de clima n√£o encontrado');
        }

        function updateDateTime() {
            try {
                const now = new Date();
                const dias = ['Domingo', 'Segunda', 'Ter√ßa', 'Quarta', 'Quinta', 'Sexta', 'S√°bado'];
                const meses = ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'];
                
                const diaSemana = dias[now.getDay()];
                const dia = now.getDate();
                const mes = meses[now.getMonth()];
                const hora = String(now.getHours()).padStart(2, '0');
                const minuto = String(now.getMinutes()).padStart(2, '0');
                
                if (datetimeWidget) {
                    datetimeWidget.textContent = `üïê ${diaSemana}, ${dia} ${mes} - ${hora}:${minuto}`;
                }
            } catch (error) {
                console.log('Erro ao atualizar data/hora:', error);
                if (datetimeWidget) {
                    datetimeWidget.textContent = 'üïê Erro ao carregar';
                }
            }
        }


        // Buscar clima (usando API gratuita do Open-Meteo)
        async function updateWeather() {
            try {
                // Coordenadas aproximadas do Rio de Janeiro (ajuste conforme sua localiza√ß√£o)
                const lat = -22.9068;
                const lon = -43.1729;
                
                const response = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
                
                if (!response.ok) {
                    throw new Error('Erro na API do clima');
                }
                
                const data = await response.json();
                
                if (data.current_weather) {
                    const temp = Math.round(data.current_weather.temperature);
                    const weatherCode = data.current_weather.weathercode;
                    
                    // Mapear c√≥digo do clima para emoji
                    let weatherEmoji = 'üå°Ô∏è';
                    if (weatherCode === 0) weatherEmoji = '‚òÄÔ∏è';
                    else if (weatherCode <= 3) weatherEmoji = '‚õÖ';
                    else if (weatherCode <= 67) weatherEmoji = 'üåßÔ∏è';
                    else if (weatherCode <= 77) weatherEmoji = 'üå®Ô∏è';
                    else if (weatherCode <= 99) weatherEmoji = '‚õàÔ∏è';
                    
                    weatherWidget.textContent = `${weatherEmoji} ${temp}¬∞C`;
                } else {
                    weatherWidget.textContent = 'üå°Ô∏è --¬∞C';
                }
            } catch (error) {
                console.log('Erro ao buscar clima:', error);
                weatherWidget.textContent = 'üå°Ô∏è --¬∞C';
            }
        }

        // Inicializar widgets
        if (datetimeWidget) {
            updateDateTime();
            setInterval(updateDateTime, 60000);
        }
        
        if (weatherWidget) {
            updateWeather();
            // Atualizar clima a cada 30 minutos
            setInterval(updateWeather, 1800000);
        }
    
        // Funcionalidade de redimensionamento do bloco de notas
        (function() {
            const notepad = document.getElementById('notepad');
            if (!notepad) return;
            
            let isResizingH = false;
            let isResizingV = false;
            let startX = 0;
            let startY = 0;
            let startWidth = 0;
            let startHeight = 0;
            let startBottom = 0;

            // Criar handle de redimensionamento horizontal (lateral esquerda)
            const resizeHandleH = document.createElement('div');
            resizeHandleH.className = 'notepad-resize-handle';
            notepad.insertBefore(resizeHandleH, notepad.firstChild);

            // Criar handle de redimensionamento vertical (canto superior esquerdo)
            const resizeHandleV = document.createElement('div');
            resizeHandleV.className = 'notepad-resize-handle-vertical';
            notepad.insertBefore(resizeHandleV, notepad.firstChild);

            // Redimensionamento horizontal
            resizeHandleH.addEventListener('mousedown', (e) => {
                isResizingH = true;
                startX = e.clientX;
                startWidth = notepad.offsetWidth;
                document.body.style.cursor = 'ew-resize';
                document.body.style.userSelect = 'none';
                e.preventDefault();
                e.stopPropagation();
            });

            // Redimensionamento vertical e horizontal (canto)
            resizeHandleV.addEventListener('mousedown', (e) => {
                isResizingV = true;
                startX = e.clientX;
                startY = e.clientY;
                startWidth = notepad.offsetWidth;
                startHeight = notepad.offsetHeight;
                const rect = notepad.getBoundingClientRect();
                startBottom = window.innerHeight - rect.bottom;
                document.body.style.cursor = 'nwse-resize';
                document.body.style.userSelect = 'none';
                e.preventDefault();
                e.stopPropagation();
            });

            document.addEventListener('mousemove', (e) => {
                if (isResizingH) {
                    const deltaX = startX - e.clientX;
                    const newWidth = startWidth + deltaX;
                    
                    if (newWidth >= 250 && newWidth <= 800) {
                        notepad.style.width = newWidth + 'px';
                    }
                }
                
                if (isResizingV) {
                    const deltaX = startX - e.clientX;
                    const deltaY = startY - e.clientY;
                    const newWidth = startWidth + deltaX;
                    const newHeight = startHeight + deltaY;
                    const maxHeight = window.innerHeight * 0.8;
                    
                    if (newWidth >= 250 && newWidth <= 800) {
                        notepad.style.width = newWidth + 'px';
                    }
                    
                    if (newHeight >= 200 && newHeight <= maxHeight) {
                        notepad.style.height = newHeight + 'px';
                        notepad.style.bottom = startBottom + 'px';
                    }
                }
            });

            document.addEventListener('mouseup', () => {
                if (isResizingH || isResizingV) {
                    isResizingH = false;
                    isResizingV = false;
                    document.body.style.cursor = '';
                    document.body.style.userSelect = '';
                }
            });
        })();

    </script>
</body>
</html>
